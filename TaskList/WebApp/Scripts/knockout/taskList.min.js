(function(){"use strict";var n,t,i=function(n,t){return function(){return n.apply(t,arguments)}};t=function(){function n(){this.update=i(this.update,this)}return n.prototype.mapping={key:function(n){return ko.utils.unwrapObservable(n.taskId)}},n.prototype.items=ko.observableArray(),n.prototype.currentItem=ko.observableArray(),n.prototype.isEmpty=ko.observable(!0),n.prototype.formFeedback=new feedbackViewModel,n.prototype.update=function(){return this.isEmpty(this.items===null||!this.items().length)},n}(),n=function(n,t){var i=this;return i.vm=n,i.apiAddress=t,i.saveEntry=function(){var n;return n=$.ajax({url:i.apiAddress+"/Task",data:ko.toJS(i.vm.currentItem),type:i.vm.currentItem().taskId===0?"POST":"PUT"}).done(function(n){var t,r;return $("#modalTask").modal("hide"),i.vm.currentItem().taskId===0?i.vm.items.unshift({taskId:ko.observable(n.data.taskId),taskType:ko.observable(n.data.taskType),createDate:ko.observable(n.data.createDate),taskTypeName:ko.observable(n.data.taskTypeName),description:ko.observable(n.data.description)}):(r=i.vm.items.mappedIndexOf({taskId:n.data.taskId}),t=i.vm.items()[r],t.description(n.data.description),t.taskType(n.data.taskType),t.taskTypeName(n.data.taskTypeName)),i.vm.update()}),i.vm.formFeedback.displayApiResult(n),!1},i.addEntry=function(){return i.vm.currentItem({taskId:0,taskType:1,description:""}),$("#modalTask").modal("show"),!1},i.editEntry=function(n){var t;return t=ko.contextFor(n),i.vm.currentItem({taskId:t.$data.taskId(),taskType:t.$data.taskType(),description:t.$data.description()}),$("#modalTask").modal("show"),!1},i.deleteEntry=function(n){var t;return t=ko.contextFor(n),bootbox.confirm('Are you sure you want to delete task "'+t.$data.description()+'"?',function(n){var r;if(n)return r=$.ajax({url:i.apiAddress+"/Task/"+t.$data.taskId(),type:"DELETE",dataType:"json",success:function(){return i.vm.items.mappedRemove({taskId:t.$data.taskId()}),i.vm.update()}}),i.vm.formFeedback.displayApiResult(r)}),!1},i.initialise=function(){return $.get(i.apiAddress+"/Task",function(n){return i.vm.items=ko.mapping.fromJS(n,i.vm.mapping),ko.applyBindings(i.vm,document.getElementById("vmTasks")),i.vm.update()}),$("#profile-feed-1").delegate(".delete","click",function(){return i.deleteEntry(this)}).delegate(".edit","click",function(){return i.editEntry(this)}),$("#modalTask button.submit").click(function(){return i.saveEntry()}),$("#vmTasks a.create").click(function(){return i.addEntry()})},i.initialise(),i},$(document).ready(function(){var i,r;return i="/api",r=new t,new n(r,i)})}).call(this)